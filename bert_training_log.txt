2025-12-15 12:05:08.438448: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-15 12:05:15.614990: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-15 12:05:47.220410: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Jeu de donnes d'entranement : 43410 lignes
Jeu de donnes de validation : 5426 lignes
Jeu de donnes de test : 5427 lignes

Aperu de la colonne des IDs avant transformation :
0    27
1    27
2     2
3    14
4     3
Name: emotion_ids, dtype: object

Aperu du DataFrame d'entranement FINAL :
                                                text  ... neutral
0  My favourite food is anything I didn't have to...  ...       1
1  Now if he does off himself, everyone will thin...  ...       1
2                     WHY THE FUCK IS BAYLESS ISOING  ...       0
3                        To make her feel threatened  ...       0
4                             Dirty Southern Wankers  ...       0

[5 rows x 30 columns]
La taille du X_train (aprs padding) est : (43410, 70)
La taille du Y_train est : (43410, 28)
======================================================================
POIDS DE CLASSE POUR WEIGHTED LOSS
======================================================================
motion                   Frquence        Poids
----------------------------------------------------------------------
admiration                 0.0951       0.1217
amusement                  0.0536       0.2158
anger                      0.0361       0.3207
annoyance                  0.0569       0.2034
approval                   0.0677       0.1710
caring                     0.0250       0.4622
confusion                  0.0315       0.3673
curiosity                  0.0505       0.2293
desire                     0.0148       0.7839
disappointment             0.0292       0.3959
disapproval                0.0466       0.2485
disgust                    0.0183       0.6336
embarrassment              0.0070       1.6583
excitement                 0.0196       0.5890
fear                       0.0137       0.8431
gratitude                  0.0613       0.1888
grief                      0.0018       6.5254
joy                        0.0334       0.3460
love                       0.0481       0.2409
nervousness                0.0038       3.0638
optimism                   0.0364       0.3178
pride                      0.0026       4.5267
realization                0.0256       0.4527
relief                     0.0035       3.2840
remorse                    0.0126       0.9219
sadness                    0.0305       0.3789
surprise                   0.0244       0.4740
neutral                    0.3276       0.0353
======================================================================

[OK] Weighted loss function creee avec succes!
   Cette fonction penalise davantage les erreurs sur les classes rares.
   Exemple: 'grief' (poids: 6.53) vs 'neutral' (poids: 0.04)

Traceback (most recent call last):
  File "C:\Users\yosrb\AppData\Roaming\Python\Python313\site-packages\transformers\activations_tf.py", line 22, in <module>
    import tf_keras as keras
ModuleNotFoundError: No module named 'tf_keras'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\yosrb\Downloads\GOEMOTION\bert.py", line 215, in <module>
    from transformers import BertTokenizer, TFBertModel, BertConfig
File "<frozen importlib._bootstrap>", line 1412, in _handle_fromlist
File "C:\Users\yosrb\AppData\Roaming\Python\Python313\site-packages\transformers\utils\import_utils.py", line 2317, in __getattr__
  module = self._get_module(self._class_to_module[name])
File "C:\Users\yosrb\AppData\Roaming\Python\Python313\site-packages\transformers\utils\import_utils.py", line 2347, in _get_module
  raise e
File "C:\Users\yosrb\AppData\Roaming\Python\Python313\site-packages\transformers\utils\import_utils.py", line 2345, in _get_module
  return importlib.import_module("." + module_name, self.__name__)
          ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "C:\Python313\Lib\importlib\__init__.py", line 88, in import_module
  return _bootstrap._gcd_import(name[level:], package, level)
          ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
File "C:\Users\yosrb\AppData\Roaming\Python\Python313\site-packages\transformers\models\bert\modeling_tf_bert.py", line 27, in <module>
  from ...activations_tf import get_tf_activation
File "C:\Users\yosrb\AppData\Roaming\Python\Python313\site-packages\transformers\activations_tf.py", line 27, in <module>
  raise ValueError(
  ...<3 lines>...
  )
ValueError: Your currently installed version of Keras is Keras 3, but this is not yet supported in Transformers. Please install the backwards-compatible tf-keras package with `pip install tf-keras`.
